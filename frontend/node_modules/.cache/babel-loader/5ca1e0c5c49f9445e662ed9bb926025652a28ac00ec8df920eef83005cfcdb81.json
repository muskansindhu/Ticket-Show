{"ast":null,"code":"import Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport LoginView from \"../views/Login.vue\";\nimport AdminDashView from \"../views/AdminDash.vue\";\nimport AdminAddShowView from \"../views/AdminAddShow.vue\";\nimport AdminEditShowView from \"../views/AdminEditShow.vue\";\nimport UserDashView from \"../views/UserDash.vue\";\nimport ShowBookingView from \"../views/ShowBooking.vue\";\nimport UserBookingView from \"../views/UserBooking.vue\";\nimport PreviewPage from \"../views/Preview.vue\";\nimport SearchShowView from \"../views/SearchShow.vue\";\nimport AnalyticsView from \"../views/Analytics.vue\";\nimport RateShowView from \"../views/RateShow.vue\";\nVue.use(VueRouter);\nfunction isAuthenticatedAsAdmin() {\n  const user = JSON.parse(localStorage.getItem(\"userSession\"));\n  return user !== null && user.role === \"admin\";\n}\nfunction isAuthenticatedAsUser() {\n  const user = JSON.parse(localStorage.getItem(\"userSession\"));\n  return user !== null && user.role === \"user\";\n}\nconst routes = [{\n  path: \"/\",\n  name: \"preview\",\n  component: PreviewPage\n}, {\n  path: \"/login\",\n  name: \"login\",\n  component: LoginView\n}, {\n  path: \"/admin/dash\",\n  name: \"admin-dash\",\n  component: AdminDashView,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"admin\"]\n  }\n}, {\n  path: \"/admin/:id/add-show\",\n  name: \"admin-add-show\",\n  component: AdminAddShowView,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"admin\"]\n  }\n}, {\n  path: \"/admin/:id/edit-show\",\n  name: \"admin-edit-show\",\n  component: AdminEditShowView,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"admin\"]\n  }\n}, {\n  path: \"/user/dash\",\n  name: \"user-dash\",\n  component: UserDashView,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"user\"]\n  }\n}, {\n  path: \"/show/:id/booking\",\n  name: \"show-booking\",\n  component: ShowBookingView,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"user\"]\n  }\n}, {\n  path: \"/rate/:id/show\",\n  name: \"rate-show\",\n  component: RateShowView,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"user\"]\n  }\n}, {\n  path: \"/user/booking\",\n  name: \"user-booking\",\n  component: UserBookingView,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"user\"]\n  }\n}, {\n  path: \"/search/:term\",\n  name: \"search\",\n  component: SearchShowView,\n  props: true,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"admin\", \"user\"]\n  }\n}, {\n  path: \"/theater/:id/analytics\",\n  name: \"analytics\",\n  component: AnalyticsView,\n  meta: {\n    requiresAuth: true,\n    allowedRoles: [\"admin\"]\n  }\n}];\nconst router = new VueRouter({\n  mode: \"history\",\n  base: process.env.BASE_URL,\n  routes\n});\nrouter.beforeEach((to, from, next) => {\n  const requiresAuth = to.matched.some(record => record.meta.requiresAuth);\n  if (requiresAuth) {\n    if (!isAuthenticatedAsAdmin() && !isAuthenticatedAsUser()) {\n      // If user is not logged in, redirect to login page\n      next({\n        name: \"login\"\n      });\n    } else {\n      // Check if the route specifies allowed roles\n      const allowedRoles = to.meta.allowedRoles;\n      if (allowedRoles) {\n        // If allowedRoles is defined, check if the user has the required role\n        const user = JSON.parse(localStorage.getItem(\"userSession\"));\n        const userRole = user.role;\n        if (!allowedRoles.includes(userRole)) {\n          // User does not have the required role for this route\n          next({\n            name: \"login\"\n          });\n        } else {\n          // User has the required role, allow access\n          next();\n        }\n      } else {\n        // No allowedRoles specified, allow access\n        next();\n      }\n    }\n  } else {\n    // No authentication required, allow access\n    next();\n  }\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","LoginView","AdminDashView","AdminAddShowView","AdminEditShowView","UserDashView","ShowBookingView","UserBookingView","PreviewPage","SearchShowView","AnalyticsView","RateShowView","use","isAuthenticatedAsAdmin","user","JSON","parse","localStorage","getItem","role","isAuthenticatedAsUser","routes","path","name","component","meta","requiresAuth","allowedRoles","props","router","mode","base","process","env","BASE_URL","beforeEach","to","from","next","matched","some","record","userRole","includes"],"sources":["/workspace/frontend/src/router/index.js"],"sourcesContent":["import Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport LoginView from \"../views/Login.vue\";\nimport AdminDashView from \"../views/AdminDash.vue\";\nimport AdminAddShowView from \"../views/AdminAddShow.vue\";\nimport AdminEditShowView from \"../views/AdminEditShow.vue\";\nimport UserDashView from \"../views/UserDash.vue\";\nimport ShowBookingView from \"../views/ShowBooking.vue\";\nimport UserBookingView from \"../views/UserBooking.vue\";\nimport PreviewPage from \"../views/Preview.vue\";\nimport SearchShowView from \"../views/SearchShow.vue\";\nimport AnalyticsView from \"../views/Analytics.vue\";\nimport RateShowView from \"../views/RateShow.vue\";\n\nVue.use(VueRouter);\n\nfunction isAuthenticatedAsAdmin() {\n  const user = JSON.parse(localStorage.getItem(\"userSession\"));\n  return user !== null && user.role === \"admin\";\n}\n\nfunction isAuthenticatedAsUser() {\n  const user = JSON.parse(localStorage.getItem(\"userSession\"));\n  return user !== null && user.role === \"user\";\n}\n\nconst routes = [\n  {\n    path: \"/\",\n    name: \"preview\",\n    component: PreviewPage,\n  },\n  {\n    path: \"/login\",\n    name: \"login\",\n    component: LoginView,\n  },\n  {\n    path: \"/admin/dash\",\n    name: \"admin-dash\",\n    component: AdminDashView,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"admin\"],\n    },\n  },\n  {\n    path: \"/admin/:id/add-show\",\n    name: \"admin-add-show\",\n    component: AdminAddShowView,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"admin\"],\n    },\n  },\n  {\n    path: \"/admin/:id/edit-show\",\n    name: \"admin-edit-show\",\n    component: AdminEditShowView,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"admin\"],\n    },\n  },\n  {\n    path: \"/user/dash\",\n    name: \"user-dash\",\n    component: UserDashView,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"user\"],\n    },\n  },\n  {\n    path: \"/show/:id/booking\",\n    name: \"show-booking\",\n    component: ShowBookingView,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"user\"],\n    },\n  },\n  {\n    path: \"/rate/:id/show\",\n    name: \"rate-show\",\n    component: RateShowView,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"user\"],\n    },\n  },\n  {\n    path: \"/user/booking\",\n    name: \"user-booking\",\n    component: UserBookingView,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"user\"],\n    },\n  },\n  {\n    path: \"/search/:term\",\n    name: \"search\",\n    component: SearchShowView,\n    props: true,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"admin\", \"user\"],\n    },\n  },\n  {\n    path: \"/theater/:id/analytics\",\n    name: \"analytics\",\n    component: AnalyticsView,\n    meta: {\n      requiresAuth: true,\n      allowedRoles: [\"admin\"],\n    },\n  },\n];\n\nconst router = new VueRouter({\n  mode: \"history\",\n  base: process.env.BASE_URL,\n  routes,\n});\n\nrouter.beforeEach((to, from, next) => {\n  const requiresAuth = to.matched.some((record) => record.meta.requiresAuth);\n\n  if (requiresAuth) {\n    if (!isAuthenticatedAsAdmin() && !isAuthenticatedAsUser()) {\n      // If user is not logged in, redirect to login page\n      next({ name: \"login\" });\n    } else {\n      // Check if the route specifies allowed roles\n      const allowedRoles = to.meta.allowedRoles;\n\n      if (allowedRoles) {\n        // If allowedRoles is defined, check if the user has the required role\n        const user = JSON.parse(localStorage.getItem(\"userSession\"));\n        const userRole = user.role;\n\n        if (!allowedRoles.includes(userRole)) {\n          // User does not have the required role for this route\n          next({ name: \"login\" });\n        } else {\n          // User has the required role, allow access\n          next();\n        }\n      } else {\n        // No allowedRoles specified, allow access\n        next();\n      }\n    }\n  } else {\n    // No authentication required, allow access\n    next();\n  }\n});\n\nexport default router;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}