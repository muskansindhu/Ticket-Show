{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  name: \"AnalyticsView\",\n  data() {\n    return {\n      theater: this.$route.params.id,\n      userSession: JSON.parse(localStorage.getItem(\"userSession\")) || null,\n      success: false,\n      theaterData: null\n    };\n  },\n  methods: {\n    async fetchData() {\n      if (this.userSession) {\n        axios.defaults.headers.common[\"Authorization\"] = `Bearer ${this.userSession.token}`;\n        const theater_id = this.$route.params.id;\n        await axios.get(`http://127.0.0.1:1234/vue/analytics/${theater_id}`).catch(() => {\n          // console.log(error);\n        });\n      }\n      this.success = false;\n      this.$forceUpdate();\n    },\n    async fetchTheaterData() {\n      try {\n        if (this.userSession) {\n          axios.defaults.headers.common[\"Authorization\"] = `Bearer ${this.userSession.token}`;\n          const theater_id = this.$route.params.id;\n          const response = await axios.get(`http://127.0.0.1:1234/vue/theater/${theater_id}`);\n          this.theaterData = response.data.theater;\n        }\n      } catch (error) {\n        console.error(\"Error fetching theater:\", error);\n      }\n    },\n    export_data() {\n      if (this.userSession) {\n        axios.defaults.headers.common[\"Authorization\"] = `Bearer ${this.userSession.token}`;\n        const theater_id = this.$route.params.id;\n        axios.get(`http://127.0.0.1:1234/vue/analytics/export_data/${theater_id}`).catch(() => {\n          // console.log(error);\n        });\n        this.success = true;\n      }\n    }\n  },\n  computed: {\n    compSeatsBookedImg() {\n      return \"http://127.0.0.1:1234/static/img/Analytics/\" + this.theaterData.theater_name + \"/Seats Booked.png\";\n    },\n    compRatingImg() {\n      return \"http://127.0.0.1:1234/static/img/Analytics/\" + this.theaterData.theater_name + \"/Rating.png\";\n    }\n  },\n  async beforeMount() {\n    this.fetchData();\n  },\n  mounted() {\n    document.title = \"Analytics\";\n  },\n  created() {\n    this.fetchTheaterData();\n    const isFirstVisit = localStorage.getItem(\"firstVisit\") !== \"true\";\n    if (isFirstVisit) {\n      localStorage.setItem(\"firstVisit\", \"true\");\n      location.reload();\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","theater","$route","params","id","userSession","JSON","parse","localStorage","getItem","success","theaterData","methods","fetchData","defaults","headers","common","token","theater_id","get","catch","$forceUpdate","fetchTheaterData","response","error","console","export_data","computed","compSeatsBookedImg","theater_name","compRatingImg","beforeMount","mounted","document","title","created","isFirstVisit","setItem","location","reload"],"sources":["src/views/Analytics.vue"],"sourcesContent":["<template>\n  <div class=\"container py-4 py-xl-5\">\n    <div class=\"row gy-4 row-cols-1 row-cols-md-2 row-cols-xl-3\">\n      <div class=\"col-md-12 col-xl-12\">\n        <div>\n          <div class=\"row\">\n            <div\n              class=\"btn-group\"\n              role=\"group\"\n              style=\"\n                padding-top: 15px;\n                padding-left: 30px;\n                padding-bottom: 15px;\n              \"\n            >\n              <button\n                class=\"text-center btn btn-success btn-lg me-2 disabled\"\n                type=\"submit\"\n                v-if=\"this.success\"\n              >\n                Successfully Exported!\n              </button>\n              <button\n                class=\"text-center btn btn-success btn-sm me-2\"\n                type=\"submit\"\n                v-else\n                @click=\"export_data\"\n              >\n                Email Data as CSV\n              </button>\n            </div>\n            <br />\n          </div>\n          <div class=\"py-4 d-flex\">\n            <div>\n              <h4>{{ this.theaterData.theater_name }}'s Analytics</h4>\n              <p>\n                The chart below shows the number of seats booked for every show\n                in\n                {{ this.theaterData.theater_name }}.\n              </p>\n            </div>\n          </div>\n          <img\n            alt=\"Analytics Image\"\n            class=\"rounded img-fluid d-block w-100 border border-dark rounded\"\n            style=\"height: 100%; object-fit: cover\"\n            :src=\"compSeatsBookedImg\"\n          />\n          <br />\n          <br />\n          <div>\n            <p>\n              The chart below shows the ratings received by every show in\n              {{ this.theaterData.theater_name }}.\n            </p>\n          </div>\n        </div>\n        <br />\n        <img\n          alt=\"Analytics Image\"\n          class=\"rounded img-fluid d-block w-100 border border-dark rounded\"\n          style=\"height: 40%; object-fit: cover\"\n          :src=\"compRatingImg\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  name: \"AnalyticsView\",\n\n  data() {\n    return {\n      theater: this.$route.params.id,\n      userSession: JSON.parse(localStorage.getItem(\"userSession\")) || null,\n      success: false,\n      theaterData: null,\n    };\n  },\n  methods: {\n    async fetchData() {\n      if (this.userSession) {\n        axios.defaults.headers.common[\n          \"Authorization\"\n        ] = `Bearer ${this.userSession.token}`;\n        const theater_id = this.$route.params.id;\n        await axios\n\n          .get(`http://127.0.0.1:1234/vue/analytics/${theater_id}`)\n          .catch(() => {\n            // console.log(error);\n          });\n      }\n      this.success = false;\n      this.$forceUpdate();\n    },\n    async fetchTheaterData() {\n      try {\n        if (this.userSession) {\n          axios.defaults.headers.common[\n            \"Authorization\"\n          ] = `Bearer ${this.userSession.token}`;\n          const theater_id = this.$route.params.id;\n\n          const response = await axios.get(\n            `http://127.0.0.1:1234/vue/theater/${theater_id}`\n          );\n          this.theaterData = response.data.theater;\n        }\n      } catch (error) {\n        console.error(\"Error fetching theater:\", error);\n      }\n    },\n    export_data() {\n      if (this.userSession) {\n        axios.defaults.headers.common[\n          \"Authorization\"\n        ] = `Bearer ${this.userSession.token}`;\n        const theater_id = this.$route.params.id;\n        axios\n          .get(`http://127.0.0.1:1234/vue/analytics/export_data/${theater_id}`)\n          .catch(() => {\n            // console.log(error);\n          });\n\n        this.success = true;\n      }\n    },\n  },\n  computed: {\n    compSeatsBookedImg() {\n      return (\n        \"http://127.0.0.1:1234/static/img/Analytics/\" +\n        this.theaterData.theater_name +\n        \"/Seats Booked.png\"\n      );\n    },\n    compRatingImg() {\n      return (\n        \"http://127.0.0.1:1234/static/img/Analytics/\" +\n        this.theaterData.theater_name +\n        \"/Rating.png\"\n      );\n    },\n  },\n  async beforeMount() {\n    this.fetchData();\n  },\n  mounted() {\n    document.title = \"Analytics\";\n  },\n  created() {\n    this.fetchTheaterData();\n    const isFirstVisit = localStorage.getItem(\"firstVisit\") !== \"true\";\n\n    if (isFirstVisit) {\n      localStorage.setItem(\"firstVisit\", \"true\");\n      location.reload();\n    }\n  },\n};\n</script>\n"],"mappings":"AAuEA,OAAAA,KAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;IACA;MACAC,OAAA,OAAAC,MAAA,CAAAC,MAAA,CAAAC,EAAA;MACAC,WAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,OAAA;MACAC,WAAA;IACA;EACA;EACAC,OAAA;IACA,MAAAC,UAAA;MACA,SAAAR,WAAA;QACAP,KAAA,CAAAgB,QAAA,CAAAC,OAAA,CAAAC,MAAA,CACA,gBACA,kBAAAX,WAAA,CAAAY,KAAA;QACA,MAAAC,UAAA,QAAAhB,MAAA,CAAAC,MAAA,CAAAC,EAAA;QACA,MAAAN,KAAA,CAEAqB,GAAA,wCAAAD,UAAA,IACAE,KAAA;UACA;QAAA,CACA;MACA;MACA,KAAAV,OAAA;MACA,KAAAW,YAAA;IACA;IACA,MAAAC,iBAAA;MACA;QACA,SAAAjB,WAAA;UACAP,KAAA,CAAAgB,QAAA,CAAAC,OAAA,CAAAC,MAAA,CACA,gBACA,kBAAAX,WAAA,CAAAY,KAAA;UACA,MAAAC,UAAA,QAAAhB,MAAA,CAAAC,MAAA,CAAAC,EAAA;UAEA,MAAAmB,QAAA,SAAAzB,KAAA,CAAAqB,GAAA,CACA,qCAAAD,UAAA,EACA;UACA,KAAAP,WAAA,GAAAY,QAAA,CAAAvB,IAAA,CAAAC,OAAA;QACA;MACA,SAAAuB,KAAA;QACAC,OAAA,CAAAD,KAAA,4BAAAA,KAAA;MACA;IACA;IACAE,YAAA;MACA,SAAArB,WAAA;QACAP,KAAA,CAAAgB,QAAA,CAAAC,OAAA,CAAAC,MAAA,CACA,gBACA,kBAAAX,WAAA,CAAAY,KAAA;QACA,MAAAC,UAAA,QAAAhB,MAAA,CAAAC,MAAA,CAAAC,EAAA;QACAN,KAAA,CACAqB,GAAA,oDAAAD,UAAA,IACAE,KAAA;UACA;QAAA,CACA;QAEA,KAAAV,OAAA;MACA;IACA;EACA;EACAiB,QAAA;IACAC,mBAAA;MACA,OACA,gDACA,KAAAjB,WAAA,CAAAkB,YAAA,GACA;IAEA;IACAC,cAAA;MACA,OACA,gDACA,KAAAnB,WAAA,CAAAkB,YAAA,GACA;IAEA;EACA;EACA,MAAAE,YAAA;IACA,KAAAlB,SAAA;EACA;EACAmB,QAAA;IACAC,QAAA,CAAAC,KAAA;EACA;EACAC,QAAA;IACA,KAAAb,gBAAA;IACA,MAAAc,YAAA,GAAA5B,YAAA,CAAAC,OAAA;IAEA,IAAA2B,YAAA;MACA5B,YAAA,CAAA6B,OAAA;MACAC,QAAA,CAAAC,MAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}