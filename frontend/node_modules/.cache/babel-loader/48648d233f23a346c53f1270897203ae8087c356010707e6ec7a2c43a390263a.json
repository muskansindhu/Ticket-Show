{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  name: \"UserBookingPage\",\n  data() {\n    return {\n      bookings: [],\n      userSession: JSON.parse(localStorage.getItem(\"userSession\")) || null,\n      showData: {} // Use an object to store show data by show_id\n    };\n  },\n\n  methods: {\n    async fetchUserBooking() {\n      try {\n        if (this.userSession && this.userSession.token) {\n          // Set the Authorization header with the JWT token\n          axios.defaults.headers.common[\"Authorization\"] = `Bearer ${this.userSession.token}`;\n          const response = await axios.get(\"http://127.0.0.1:1234/vue/user/bookings\");\n          this.bookings = response.data.bookings;\n          console.log(this.bookings);\n          for (const booking of this.bookings) {\n            await this.fetchShowfromBooking(booking.show_id);\n          }\n        }\n      } catch (error) {\n        console.error(\"Error fetching bookings:\", error);\n      }\n    },\n    async fetchShowfromBooking(show_id) {\n      try {\n        const response = await axios.get(`http://127.0.0.1:1234/vue/theater/show/${show_id}`);\n        const showData = response.data;\n\n        // Use the show_id as the key to store show data\n        this.$set(this.showData, show_id, showData);\n      } catch (error) {\n        console.error(`Error fetching show data for show_id ${show_id}:`, error);\n      }\n    },\n    getShowName(show_id) {\n      const show = this.showData[show_id];\n      return show ? show.show_name : \"N/A\";\n    },\n    getShowRating(show_id) {\n      const show = this.showData[show_id];\n      return show ? show.rating : \"N/A\";\n    }\n  },\n  async created() {\n    await this.fetchUserBooking();\n  }\n};","map":{"version":3,"names":["axios","name","data","bookings","userSession","JSON","parse","localStorage","getItem","showData","methods","fetchUserBooking","token","defaults","headers","common","response","get","console","log","booking","fetchShowfromBooking","show_id","error","$set","getShowName","show","show_name","getShowRating","rating","created"],"sources":["src/components/UserBooking.vue"],"sourcesContent":["<template>\n  <div>\n    <br />\n    <br />\n    <div class=\"row\">\n      <div\n        class=\"col-md-10 mx-auto\"\n        v-for=\"(booking, index) in bookings\"\n        :key=\"index\"\n      >\n        <!-- Booking Card -->\n        <div class=\"card mb-3\">\n          <div class=\"card-body\">\n            <!-- Display Booking Information -->\n            <h5 class=\"card-title\">Booking {{ index + 1 }}</h5>\n            <div class=\"d-flex justify-content-between align-items-start\">\n              <div>\n                <p class=\"card-text\">\n                  <strong>Show Name:</strong>\n                  {{ getShowName(booking.show_id) }} <br />\n                  <strong>Show Rating:</strong>\n                  {{ getShowRating(booking.show_id) }} <br />\n                  <strong>Tickets Booked:</strong> {{ booking.tickets_booked }}\n                </p>\n              </div>\n              <a\n                :href=\"'/rate/' + booking.show_id + '/show'\"\n                class=\"btn btn-outline-success\"\n              >\n                Rate Show\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  name: \"UserBookingPage\",\n  data() {\n    return {\n      bookings: [],\n      userSession: JSON.parse(localStorage.getItem(\"userSession\")) || null,\n      showData: {}, // Use an object to store show data by show_id\n    };\n  },\n\n  methods: {\n    async fetchUserBooking() {\n      try {\n        if (this.userSession && this.userSession.token) {\n          // Set the Authorization header with the JWT token\n          axios.defaults.headers.common[\n            \"Authorization\"\n          ] = `Bearer ${this.userSession.token}`;\n          const response = await axios.get(\n            \"http://127.0.0.1:1234/vue/user/bookings\"\n          );\n          this.bookings = response.data.bookings;\n          console.log(this.bookings);\n\n          for (const booking of this.bookings) {\n            await this.fetchShowfromBooking(booking.show_id);\n          }\n        }\n      } catch (error) {\n        console.error(\"Error fetching bookings:\", error);\n      }\n    },\n    async fetchShowfromBooking(show_id) {\n      try {\n        const response = await axios.get(\n          `http://127.0.0.1:1234/vue/theater/show/${show_id}`\n        );\n        const showData = response.data;\n\n        // Use the show_id as the key to store show data\n        this.$set(this.showData, show_id, showData);\n      } catch (error) {\n        console.error(\n          `Error fetching show data for show_id ${show_id}:`,\n          error\n        );\n      }\n    },\n    getShowName(show_id) {\n      const show = this.showData[show_id];\n      return show ? show.show_name : \"N/A\";\n    },\n    getShowRating(show_id) {\n      const show = this.showData[show_id];\n      return show ? show.rating : \"N/A\";\n    },\n  },\n\n  async created() {\n    await this.fetchUserBooking();\n  },\n};\n</script>\n"],"mappings":"AAwCA,OAAAA,KAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,QAAA;MACAC,WAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,QAAA;IACA;EACA;;EAEAC,OAAA;IACA,MAAAC,iBAAA;MACA;QACA,SAAAP,WAAA,SAAAA,WAAA,CAAAQ,KAAA;UACA;UACAZ,KAAA,CAAAa,QAAA,CAAAC,OAAA,CAAAC,MAAA,CACA,gBACA,kBAAAX,WAAA,CAAAQ,KAAA;UACA,MAAAI,QAAA,SAAAhB,KAAA,CAAAiB,GAAA,CACA,yCACA;UACA,KAAAd,QAAA,GAAAa,QAAA,CAAAd,IAAA,CAAAC,QAAA;UACAe,OAAA,CAAAC,GAAA,MAAAhB,QAAA;UAEA,WAAAiB,OAAA,SAAAjB,QAAA;YACA,WAAAkB,oBAAA,CAAAD,OAAA,CAAAE,OAAA;UACA;QACA;MACA,SAAAC,KAAA;QACAL,OAAA,CAAAK,KAAA,6BAAAA,KAAA;MACA;IACA;IACA,MAAAF,qBAAAC,OAAA;MACA;QACA,MAAAN,QAAA,SAAAhB,KAAA,CAAAiB,GAAA,CACA,0CAAAK,OAAA,EACA;QACA,MAAAb,QAAA,GAAAO,QAAA,CAAAd,IAAA;;QAEA;QACA,KAAAsB,IAAA,MAAAf,QAAA,EAAAa,OAAA,EAAAb,QAAA;MACA,SAAAc,KAAA;QACAL,OAAA,CAAAK,KAAA,CACA,wCAAAD,OAAA,KACAC,KACA;MACA;IACA;IACAE,YAAAH,OAAA;MACA,MAAAI,IAAA,QAAAjB,QAAA,CAAAa,OAAA;MACA,OAAAI,IAAA,GAAAA,IAAA,CAAAC,SAAA;IACA;IACAC,cAAAN,OAAA;MACA,MAAAI,IAAA,QAAAjB,QAAA,CAAAa,OAAA;MACA,OAAAI,IAAA,GAAAA,IAAA,CAAAG,MAAA;IACA;EACA;EAEA,MAAAC,QAAA;IACA,WAAAnB,gBAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}