{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  name: \"AdminDashPage\",\n  data() {\n    return {\n      theaters: [],\n      formData: {\n        theater_name: \"\",\n        location: \"\",\n        capacity: \"\"\n      },\n      userSession: JSON.parse(localStorage.getItem(\"userSession\")) || null\n    };\n  },\n  methods: {\n    async getTheater() {\n      const path = \"http://127.0.0.1:1234/vue/all/theater\";\n      try {\n        const response = await axios.get(path);\n        this.theaters = response.data.theaters;\n        this.loadShowsForTheaters();\n      } catch (error) {\n        console.error(\"Error fetching theaters:\", error);\n      }\n    },\n    async getShowsForTheater(theater) {\n      const path = `http://127.0.0.1:1234/vue/theater/${theater.roll}/show`;\n      try {\n        const response = await axios.get(path);\n        this.$set(theater, \"shows\", response.data.show);\n      } catch (error) {\n        console.error(`Error fetching shows for theater ${theater.roll}:`, error);\n      }\n    },\n    async addTheaterForm() {\n      try {\n        if (this.userSession && this.userSession.token) {\n          // Set the Authorization header with the JWT token\n          axios.defaults.headers.common[\"Authorization\"] = `Bearer ${this.userSession.token}`;\n          const formData = new FormData();\n          formData.append(\"theater_name\", this.formData.theater_name);\n          formData.append(\"location\", this.formData.location);\n          formData.append(\"capacity\", this.formData.capacity);\n          const response = await axios.post(\"http://127.0.0.1:1234/vue/theater\", formData);\n          console.log(\"User Token:\", this.userSession.token);\n          console.log(response);\n          this.getTheater();\n        } else {\n          // Handle the case where the user is not authenticated\n          console.error(\"User is not authenticated.\");\n          // You can redirect to the login page or show an error message here\n        }\n      } catch (error) {\n        console.error(\"AxiosError:\", error);\n        console.log(this.userSession.token);\n        if (error.response) {\n          console.error(\"Response Data:\", error.response.data);\n        } else {\n          console.error(\"Network Error:\", error.message);\n        }\n        alert(\"Oops! An error occurred. Theater was not added.\");\n      }\n    },\n    deleteTheater(theater_id) {\n      try {\n        if (this.userSession && this.userSession.token) {\n          // Set the Authorization header with the JWT token\n          axios.defaults.headers.common[\"Authorization\"] = `Bearer ${this.userSession.token}`;\n          const response = axios.delete(`http://127.0.0.1:1234/vue/theater/${theater_id}`);\n          console.log(response);\n          alert(\"Theater deleted Successfully\");\n          this.getTheater();\n        } else {\n          // Handle the case where the user is not authenticated\n          console.error(\"User is not authenticated.\");\n          // You can redirect to the login page or show an error message here\n        }\n      } catch (error) {\n        console.error(\"AxiosError:\", error);\n        if (error.response) {\n          console.error(\"Response Data:\", error.response.data);\n        } else {\n          console.error(\"Network Error:\", error.message);\n        }\n        alert(\"Oops! An error occurred. Theater was not deleted.\");\n      }\n    },\n    loadShowsForTheaters() {\n      for (const theater of this.theaters) {\n        this.getShowsForTheater(theater);\n      }\n    },\n    initForm() {\n      this.formData.theater_name = \"\";\n      this.formData.location = \"\";\n      this.formData.capacity = \"\";\n    },\n    onSubmit(e) {\n      e.preventDefault();\n      this.$refs.theaterModal.hide();\n      const payload = {\n        theater_name: this.formData.theater_name,\n        location: this.formData.location,\n        capacity: this.formData.capacity\n      };\n      this.addTheaterForm(payload);\n    },\n    posterImg(showName) {\n      return `http://127.0.0.1:1234/static/img/Posters/${showName}.webp`;\n    }\n  },\n  async created() {\n    await this.getTheater();\n    await this.loadShowsForTheaters();\n    const fetchData = async () => {\n      try {\n        await this.getTheater();\n        await this.loadShowsForTheaters();\n      } catch (error) {\n        console.error(\"Error fetching theaters:\", error);\n      }\n    };\n    fetchData();\n    setInterval(fetchData, 60000);\n  }\n};","map":{"version":3,"names":["axios","name","data","theaters","formData","theater_name","location","capacity","userSession","JSON","parse","localStorage","getItem","methods","getTheater","path","response","get","loadShowsForTheaters","error","console","getShowsForTheater","theater","roll","$set","show","addTheaterForm","token","defaults","headers","common","FormData","append","post","log","message","alert","deleteTheater","theater_id","delete","initForm","onSubmit","e","preventDefault","$refs","theaterModal","hide","payload","posterImg","showName","created","fetchData","setInterval"],"sources":["src/components/AdminDash.vue"],"sourcesContent":["<template>\n  <div>\n    <br />\n    <br />\n    <div class=\"col-md-12 text-center\">\n      <button type=\"button\" class=\"btn btn-success\" v-b-modal.theater-modal>\n        Add Theater\n      </button>\n    </div>\n\n    <div class=\"row justify-content-center\">\n      <div class=\"col-md-10\" v-for=\"(theater, index) in theaters\" :key=\"index\">\n        <br />\n        <div class=\"card mb-3\">\n          <div class=\"card-header d-flex justify-content-between\">\n            <div class=\"d-flex justify-content-between align-items-baseline\">\n              <div>\n                <h5 class=\"card-title\">{{ theater.theater_name }},</h5>\n              </div>\n              &nbsp;\n              <div>\n                <h6>{{ theater.location }},</h6>\n              </div>\n              &nbsp;\n              <div>\n                <h6><strong>Capacity:</strong> {{ theater.capacity }}</h6>\n              </div>\n            </div>\n\n            <div class=\"buttons\">\n              <a\n                :href=\"'/admin/' + theater.roll + '/add-show'\"\n                class=\"btn btn-outline-success btn-sm\"\n              >\n                Add Show\n              </a>\n              &nbsp;\n              <a\n                :href=\"'/theater/' + theater.roll + '/analytics'\"\n                class=\"btn btn-outline-warning btn-sm\"\n              >\n                Analytics\n              </a>\n              &nbsp;\n              <button\n                type=\"button\"\n                class=\"btn btn-outline-danger btn-sm\"\n                @click=\"deleteTheater(theater.roll)\"\n              >\n                Delete Theater\n              </button>\n            </div>\n          </div>\n          <div>\n            <div class=\"card-body\">\n              <!-- Show cards -->\n              <div class=\"row\" v-if=\"theater.shows && theater.shows.length > 0\">\n                <div\n                  class=\"col-md-4\"\n                  v-for=\"(show, showIndex) in theater.shows\"\n                  :key=\"showIndex\"\n                >\n                  <div class=\"card mb-3\">\n                    <div class=\"card-body text-center\">\n                      <div>\n                        <img\n                          :src=\"posterImg(show.show_name)\"\n                          alt=\"Image\"\n                          class=\"card-img-top w-100\"\n                          style=\"max-height: 400px; max-width: 100%\"\n                        />\n                      </div>\n                      <h6 class=\"card-title\">{{ show.show_name }}</h6>\n                      <p class=\"card-text\">\n                        <strong>Show Time:</strong> {{ show.time }}\n                      </p>\n                      <a\n                        :href=\"'/admin/' + show.roll + '/edit-show'\"\n                        class=\"btn btn-info btn-sm\"\n                      >\n                        Actions\n                      </a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <p v-else>No shows available for this theater.</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Add Theater Model -->\n    <b-modal\n      ref=\"theaterModal\"\n      id=\"theater-modal\"\n      title=\"Add a Theater\"\n      hide-backdrop\n      hide-footer\n    >\n      <b-form class=\"w-100\">\n        <b-form-group id=\"theater_name\" label-for=\"theater_name_input\">\n          <b-form-input\n            id=\"theater_name_input\"\n            type=\"text\"\n            v-model=\"formData.theater_name\"\n            placeholder=\"Enter Theater Name\"\n            required\n          >\n          </b-form-input>\n          <br />\n        </b-form-group>\n        <b-form-group id=\"location\" label-for=\"location_input\">\n          <b-form-input\n            id=\"location_input\"\n            type=\"text\"\n            v-model=\"formData.location\"\n            placeholder=\"Enter Theater Location\"\n            required\n          >\n          </b-form-input>\n        </b-form-group>\n        <br />\n        <b-form-group id=\"capacity\" label-for=\"capacity_input\">\n          <b-form-input\n            id=\"capacity_input\"\n            type=\"number\"\n            v-model=\"formData.capacity\"\n            placeholder=\"Enter Theater Capacity\"\n            required\n          >\n          </b-form-input>\n        </b-form-group>\n        <br />\n        <div class=\"text-center\">\n          <b-button type=\"submit\" variant=\"success\" @click=\"onSubmit\"\n            >Submit</b-button\n          >\n        </div>\n      </b-form>\n    </b-modal>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  name: \"AdminDashPage\",\n  data() {\n    return {\n      theaters: [],\n      formData: {\n        theater_name: \"\",\n        location: \"\",\n        capacity: \"\",\n      },\n      userSession: JSON.parse(localStorage.getItem(\"userSession\")) || null,\n    };\n  },\n  methods: {\n    async getTheater() {\n      const path = \"http://127.0.0.1:1234/vue/all/theater\";\n      try {\n        const response = await axios.get(path);\n        this.theaters = response.data.theaters;\n        this.loadShowsForTheaters();\n      } catch (error) {\n        console.error(\"Error fetching theaters:\", error);\n      }\n    },\n\n    async getShowsForTheater(theater) {\n      const path = `http://127.0.0.1:1234/vue/theater/${theater.roll}/show`;\n      try {\n        const response = await axios.get(path);\n        this.$set(theater, \"shows\", response.data.show);\n      } catch (error) {\n        console.error(\n          `Error fetching shows for theater ${theater.roll}:`,\n          error\n        );\n      }\n    },\n\n    async addTheaterForm() {\n      try {\n        if (this.userSession && this.userSession.token) {\n          // Set the Authorization header with the JWT token\n          axios.defaults.headers.common[\n            \"Authorization\"\n          ] = `Bearer ${this.userSession.token}`;\n          const formData = new FormData();\n          formData.append(\"theater_name\", this.formData.theater_name);\n          formData.append(\"location\", this.formData.location);\n          formData.append(\"capacity\", this.formData.capacity);\n\n          const response = await axios.post(\n            \"http://127.0.0.1:1234/vue/theater\",\n            formData\n          );\n          console.log(\"User Token:\", this.userSession.token);\n          console.log(response);\n          this.getTheater();\n        } else {\n          // Handle the case where the user is not authenticated\n          console.error(\"User is not authenticated.\");\n          // You can redirect to the login page or show an error message here\n        }\n      } catch (error) {\n        console.error(\"AxiosError:\", error);\n        console.log(this.userSession.token);\n\n        if (error.response) {\n          console.error(\"Response Data:\", error.response.data);\n        } else {\n          console.error(\"Network Error:\", error.message);\n        }\n        alert(\"Oops! An error occurred. Theater was not added.\");\n      }\n    },\n    deleteTheater(theater_id) {\n      try {\n        if (this.userSession && this.userSession.token) {\n          // Set the Authorization header with the JWT token\n          axios.defaults.headers.common[\n            \"Authorization\"\n          ] = `Bearer ${this.userSession.token}`;\n          const response = axios.delete(\n            `http://127.0.0.1:1234/vue/theater/${theater_id}`\n          );\n          console.log(response);\n          alert(\"Theater deleted Successfully\");\n          this.getTheater();\n        } else {\n          // Handle the case where the user is not authenticated\n          console.error(\"User is not authenticated.\");\n          // You can redirect to the login page or show an error message here\n        }\n      } catch (error) {\n        console.error(\"AxiosError:\", error);\n        if (error.response) {\n          console.error(\"Response Data:\", error.response.data);\n        } else {\n          console.error(\"Network Error:\", error.message);\n        }\n        alert(\"Oops! An error occurred. Theater was not deleted.\");\n      }\n    },\n\n    loadShowsForTheaters() {\n      for (const theater of this.theaters) {\n        this.getShowsForTheater(theater);\n      }\n    },\n\n    initForm() {\n      this.formData.theater_name = \"\";\n      this.formData.location = \"\";\n      this.formData.capacity = \"\";\n    },\n\n    onSubmit(e) {\n      e.preventDefault();\n      this.$refs.theaterModal.hide();\n      const payload = {\n        theater_name: this.formData.theater_name,\n        location: this.formData.location,\n        capacity: this.formData.capacity,\n      };\n      this.addTheaterForm(payload);\n    },\n    posterImg(showName) {\n      return `http://127.0.0.1:1234/static/img/Posters/${showName}.webp`;\n    },\n  },\n  async created() {\n    await this.getTheater();\n    await this.loadShowsForTheaters();\n    const fetchData = async () => {\n      try {\n        await this.getTheater();\n        await this.loadShowsForTheaters();\n      } catch (error) {\n        console.error(\"Error fetching theaters:\", error);\n      }\n    };\n    fetchData();\n\n    setInterval(fetchData, 60000);\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}